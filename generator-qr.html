<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Kod√≥w QR - Sklep</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            background: #f5f5f5;
            border: none;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab:hover {
            background: #e8e8e8;
        }

        .tab.active:hover {
            background: white;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        .generate-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
            margin-top: 10px;
        }

        .generate-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .qr-result {
            margin-top: 30px;
            text-align: center;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
            display: none;
        }

        .qr-result.show {
            display: block;
        }

        #qrcode, #qrcode-money {
            display: inline-block;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 20px 0;
        }

        .download-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
        }

        .download-btn:hover {
            background: #1976D2;
        }

        .json-preview {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            word-wrap: break-word;
        }

        .quick-products {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        .quick-btn {
            background: #E3F2FD;
            color: #1976D2;
            border: 2px solid #1976D2;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .quick-btn:hover {
            background: #1976D2;
            color: white;
        }

        .info-box {
            background: #FFF9C4;
            border-left: 4px solid #FBC02D;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info-box strong {
            color: #F57C00;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî≤ Generator Kod√≥w QR</h1>
            <p>Generuj kody dla skanera zakup√≥w</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('product')">üì¶ Produkty</button>
            <button class="tab" onclick="switchTab('money')">üíµ P≈Çatno≈õci</button>
        </div>

        <div class="content">
            <!-- Tab: Produkty -->
            <div id="product-tab" class="tab-content active">
                <div class="info-box">
                    <strong>üí° Jak to dzia≈Ça:</strong> Wpisz nazwƒô i cenƒô produktu, a kod QR zostanie automatycznie wygenerowany w formacie JSON.
                </div>

                <div class="form-group">
                    <label for="productName">Nazwa produktu:</label>
                    <input type="text" id="productName" placeholder="np. Mleko, Chleb, Par√≥wki">
                </div>

                <div class="form-group">
                    <label for="productPrice">Cena (z≈Ç):</label>
                    <input type="number" id="productPrice" step="0.01" placeholder="np. 4.50">
                </div>

                <div class="json-preview" id="jsonPreview">
                    {"nazwa":"","cena":0}
                </div>

                <button class="generate-btn" onclick="generateProductQR()">
                    üî≤ GENERUJ KOD QR
                </button>

                <div class="qr-result" id="qr-result-product">
                    <h3>Tw√≥j kod QR:</h3>
                    <div id="qrcode"></div>
                    <button class="download-btn" onclick="downloadQR('qrcode')">üì• Pobierz kod</button>
                    <button class="download-btn" onclick="printQR()">üñ®Ô∏è Drukuj</button>
                </div>

                <h3 style="margin-top: 30px; color: #667eea;">‚ö° Szybkie generowanie:</h3>
                <div class="quick-products">
                    <button class="quick-btn" onclick="quickProduct('Mleko', 4.50)">Mleko 4.50z≈Ç</button>
                    <button class="quick-btn" onclick="quickProduct('Chleb', 3.20)">Chleb 3.20z≈Ç</button>
                    <button class="quick-btn" onclick="quickProduct('Mas≈Ço', 6.99)">Mas≈Ço 6.99z≈Ç</button>
                    <button class="quick-btn" onclick="quickProduct('Par√≥wki', 10.00)">Par√≥wki 10.00z≈Ç</button>
                    <button class="quick-btn" onclick="quickProduct('Ser ≈º√≥≈Çty', 12.50)">Ser 12.50z≈Ç</button>
                    <button class="quick-btn" onclick="quickProduct('Jogurt', 2.99)">Jogurt 2.99z≈Ç</button>
                </div>
            </div>

            <!-- Tab: P≈Çatno≈õci -->
            <div id="money-tab" class="tab-content">
                <div class="info-box">
                    <strong>üí° Generuj kody dla banknot√≥w:</strong> Wybierz warto≈õƒá banknotu lub wpisz w≈ÇasnƒÖ kwotƒô.
                </div>

                <div class="form-group">
                    <label for="moneyAmount">Kwota (z≈Ç):</label>
                    <input type="number" id="moneyAmount" step="1" placeholder="np. 50">
                </div>

                <div class="json-preview" id="jsonPreviewMoney">
                    {"money":0}
                </div>

                <button class="generate-btn" onclick="generateMoneyQR()">
                    üî≤ GENERUJ KOD P≈ÅATNO≈öCI
                </button>

                <div class="qr-result" id="qr-result-money">
                    <h3>Tw√≥j kod QR:</h3>
                    <div id="qrcode-money"></div>
                    <button class="download-btn" onclick="downloadQR('qrcode-money')">üì• Pobierz kod</button>
                    <button class="download-btn" onclick="printQR()">üñ®Ô∏è Drukuj</button>
                </div>

                <h3 style="margin-top: 30px; color: #667eea;">‚ö° Popularne banknoty:</h3>
                <div class="quick-products">
                    <button class="quick-btn" onclick="quickMoney(10)">10 z≈Ç</button>
                    <button class="quick-btn" onclick="quickMoney(20)">20 z≈Ç</button>
                    <button class="quick-btn" onclick="quickMoney(50)">50 z≈Ç</button>
                    <button class="quick-btn" onclick="quickMoney(100)">100 z≈Ç</button>
                    <button class="quick-btn" onclick="quickMoney(200)">200 z≈Ç</button>
                    <button class="quick-btn" onclick="quickMoney(500)">500 z≈Ç</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Zmiana zak≈Çadek
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            if (tab === 'product') {
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.getElementById('product-tab').classList.add('active');
            } else {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('money-tab').classList.add('active');
            }
        }

        // Aktualizacja podglƒÖdu JSON dla produkt√≥w
        document.getElementById('productName').addEventListener('input', updateProductPreview);
        document.getElementById('productPrice').addEventListener('input', updateProductPreview);

        function updateProductPreview() {
            const name = document.getElementById('productName').value || '';
            const price = parseFloat(document.getElementById('productPrice').value) || 0;
            const json = JSON.stringify({nazwa: name, cena: price});
            document.getElementById('jsonPreview').textContent = json;
        }

        // Aktualizacja podglƒÖdu JSON dla p≈Çatno≈õci
        document.getElementById('moneyAmount').addEventListener('input', updateMoneyPreview);

        function updateMoneyPreview() {
            const amount = parseFloat(document.getElementById('moneyAmount').value) || 0;
            const json = JSON.stringify({money: amount});
            document.getElementById('jsonPreviewMoney').textContent = json;
        }

        // Generowanie QR dla produkt√≥w
        function generateProductQR() {
            const name = document.getElementById('productName').value;
            const price = parseFloat(document.getElementById('productPrice').value);

            if (!name || !price) {
                alert('Wype≈Çnij nazwƒô i cenƒô produktu!');
                return;
            }

            const data = JSON.stringify({nazwa: name, cena: price});
            
            document.getElementById('qrcode').innerHTML = '';
            new QRCode(document.getElementById('qrcode'), {
                text: data,
                width: 256,
                height: 256,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });

            document.getElementById('qr-result-product').classList.add('show');
        }

        // Generowanie QR dla p≈Çatno≈õci
        function generateMoneyQR() {
            const amount = parseFloat(document.getElementById('moneyAmount').value);

            if (!amount) {
                alert('Wype≈Çnij kwotƒô!');
                return;
            }

            const data = JSON.stringify({money: amount});
            
            document.getElementById('qrcode-money').innerHTML = '';
            new QRCode(document.getElementById('qrcode-money'), {
                text: data,
                width: 256,
                height: 256,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });

            document.getElementById('qr-result-money').classList.add('show');
        }

        // Szybkie generowanie produktu
        function quickProduct(name, price) {
            document.getElementById('productName').value = name;
            document.getElementById('productPrice').value = price;
            updateProductPreview();
            generateProductQR();
        }

        // Szybkie generowanie p≈Çatno≈õci
        function quickMoney(amount) {
            document.getElementById('moneyAmount').value = amount;
            updateMoneyPreview();
            generateMoneyQR();
        }

        // Pobieranie QR
        function downloadQR(elementId) {
            const canvas = document.querySelector(`#${elementId} canvas`);
            if (!canvas) {
                alert('Najpierw wygeneruj kod QR!');
                return;
            }

            const url = canvas.toDataURL('image/png');
            const link = document.createElement('a');
            link.download = `qr-code-${Date.now()}.png`;
            link.href = url;
            link.click();
        }

        // Drukowanie
        function printQR() {
            // Znajd≈∫ aktywnƒÖ zak≈Çadkƒô i odpowiedni kod QR
            const productTab = document.getElementById('product-tab');
            const isProductActive = productTab.classList.contains('active');
            
            const qrElement = isProductActive 
                ? document.getElementById('qrcode')
                : document.getElementById('qrcode-money');
            
            const canvas = qrElement.querySelector('canvas');
            
            if (!canvas) {
                alert('Najpierw wygeneruj kod QR!');
                return;
            }

            // Konwertuj canvas na base64 - u≈ºywamy wysokiej jako≈õci
            const imgData = canvas.toDataURL('image/png', 1.0);
            
            if (isProductActive) {
                // Dla produkt√≥w - prosty wydruk
                const productName = document.getElementById('productName').value;
                const productPrice = document.getElementById('productPrice').value;
                const title = productName && productPrice ? `${productName} - ${productPrice} z≈Ç` : 'Kod QR';
                
                printSimpleQR(imgData, title);
            } else {
                // Dla p≈Çatno≈õci - wizualizacja banknotu
                const amount = document.getElementById('moneyAmount').value;
                printBanknote(imgData, amount);
            }
        }

        function printSimpleQR(imgData, title) {
            const printContent = `
                <div style="text-align: center; padding: 20px;">
                    <h2 style="margin-bottom: 20px; font-size: 18px;">${title}</h2>
                    <img src="${imgData}" style="width: 128px; height: 128px;" />
                </div>
            `;
            
            createPrintWindow(printContent);
        }

        function printBanknote(imgData, amount) {
            const printContent = `
                <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 20px;">
                    <div style="
                        width: 400px;
                        height: 200px;
                        border: 3px solid #333;
                        border-radius: 10px;
                        background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);
                        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                        display: flex;
                        align-items: center;
                        padding: 20px;
                        position: relative;
                        overflow: hidden;
                    ">
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            background: repeating-linear-gradient(
                                45deg,
                                transparent,
                                transparent 10px,
                                rgba(255,255,255,0.1) 10px,
                                rgba(255,255,255,0.1) 20px
                            );
                            pointer-events: none;
                        "></div>
                        <div style="
                            flex-shrink: 0;
                            background: white;
                            padding: 10px;
                            border-radius: 8px;
                            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                            z-index: 1;
                        ">
                            <img src="${imgData}" style="display: block; width: 120px; height: 120px;" />
                        </div>
                        <div style="
                            flex: 1;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            justify-content: center;
                            padding-left: 30px;
                            position: relative;
                            z-index: 1;
                        ">
                            <div style="
                                font-size: 24px;
                                font-weight: bold;
                                color: #333;
                                margin-bottom: 10px;
                                text-transform: uppercase;
                                letter-spacing: 2px;
                            ">BANKNOT</div>
                            <div style="
                                font-size: 72px;
                                font-weight: bold;
                                color: #1a1a1a;
                                line-height: 1;
                                text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
                            ">${amount}</div>
                            <div style="
                                font-size: 28px;
                                font-weight: bold;
                                color: #555;
                                margin-top: 5px;
                            ">z≈Ç</div>
                        </div>
                    </div>
                </div>
            `;
            
            createPrintWindow(printContent);
        }

        function createPrintWindow(content) {
            // Utw√≥rz iframe ukryty w dokumencie
            const iframe = document.createElement('iframe');
            iframe.style.position = 'fixed';
            iframe.style.right = '0';
            iframe.style.bottom = '0';
            iframe.style.width = '0';
            iframe.style.height = '0';
            iframe.style.border = 'none';
            document.body.appendChild(iframe);
            
            const doc = iframe.contentWindow.document;
            doc.open();
            doc.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Drukuj</title>
                    <style>
                        * {
                            margin: 0;
                            padding: 0;
                            box-sizing: border-box;
                        }
                        body {
                            font-family: Arial, sans-serif;
                        }
                        @media print {
                            body {
                                padding: 0;
                            }
                            @page {
                                margin: 0.5cm;
                            }
                        }
                    </style>
                </head>
                <body>
                    ${content}
                </body>
                </html>
            `);
            doc.close();
            
            // Poczekaj na za≈Çadowanie, potem drukuj
            iframe.onload = function() {
                setTimeout(() => {
                    iframe.contentWindow.focus();
                    iframe.contentWindow.print();
                    
                    // Usu≈Ñ iframe po wydrukowaniu
                    setTimeout(() => {
                        document.body.removeChild(iframe);
                    }, 1000);
                }, 250);
            };
        }
    </script>
</body>
</html>
